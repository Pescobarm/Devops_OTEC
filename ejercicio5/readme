ejercicio mÃ¡s avanzado que simule un entorno real de microservicios, ideal para estudiantes que ya manejan lo bÃ¡sico de Docker, Flask, PostgreSQL y Redis.

ğŸ§ª Ejercicio Experto: Arquitectura de Microservicios con API Gateway + Flask Services + PostgreSQL + Redis
ğŸ¯ Objetivo:
Simular una arquitectura moderna basada en microservicios con:

MÃºltiples servicios Flask independientes

Un API Gateway (con NGINX) que enruta las peticiones

Una base de datos PostgreSQL por servicio

Redis como cachÃ© compartido

ComunicaciÃ³n entre servicios por HTTP interno

ğŸ§± Servicios incluidos:
Servicio	FunciÃ³n
api-gateway	NGINX que enruta las llamadas
user-service	Flask con su propia base PostgreSQL
product-service	Flask con Redis como cachÃ©
redis	CachÃ© de productos
db-users	PostgreSQL para usuarios

ğŸ“‚ Estructura del proyecto
csharp
Copiar cÃ³digo
microservices-app/
â”œâ”€â”€ api-gateway/
â”‚   â””â”€â”€ nginx.conf
â”‚
â”œâ”€â”€ user-service/
â”‚   â”œâ”€â”€ app.py
â”‚   â””â”€â”€ requirements.txt
â”‚
â”œâ”€â”€ product-service/
â”‚   â”œâ”€â”€ app.py
â”‚   â””â”€â”€ requirements.txt
â”‚
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ Dockerfile  (base para ambos servicios Flask)
ğŸš€ Â¿CÃ³mo ejecutar?
bash
Copiar cÃ³digo
docker compose up --build
âœ… Â¿CÃ³mo probarlo?
Accede al API Gateway:

Usuarios: http://localhost:8080/users

Productos: http://localhost:8080/products

Observa que /products usa cache Redis.

Observa que /users escribe/lee en PostgreSQL propio.

ğŸ“ˆ Â¿QuÃ© se aprende con esto?
Concepto	AplicaciÃ³n en el ejercicio
Arquitectura microservicios	Servicios independientes
API Gateway (NGINX)	Enrutamiento de endpoints
ComunicaciÃ³n HTTP interna	proxy_pass entre contenedores
PostgreSQL dedicado	user-service persistente
Redis como cachÃ© compartido	product-service
Variables de entorno	ConfiguraciÃ³n desacoplada
Docker Compose avanzado	Multi-build + redes + volÃºmenes

ğŸ“ Actividad sugerida:
DesafÃ­o final para estudiantes:

Agregar un nuevo microservicio (por ejemplo, â€œordenesâ€).

Conectarlo al gateway.

Implementar su propia DB o cache.

ğŸ“ Actividad Final: Expandiendo la Arquitectura - Agrega un Nuevo Microservicio
ğŸ¯ Objetivo de la actividad:
Aplicar los conocimientos adquiridos para diseÃ±ar, construir y conectar un nuevo microservicio a la arquitectura existente, integrÃ¡ndolo con el API Gateway.

ğŸ“Œ Requisitos tÃ©cnicos
Cada estudiante (o grupo) debe:

âœ… Crear un microservicio Flask llamado order-service que:

Exponga un endpoint /orders.

Use PostgreSQL para guardar Ã³rdenes simples (por ejemplo, { id, user_id, product_id }).

Se comunique con el API Gateway vÃ­a NGINX.

âœ… Crear su propia base de datos PostgreSQL (db-orders).

âœ… Conectarlo en docker-compose.yml y agregarlo como backend en nginx.conf.

ğŸ§± Requisitos mÃ­nimos de order-service

Base de datos:
sql
Copiar cÃ³digo
CREATE TABLE orders (
  id SERIAL PRIMARY KEY,
  user_id INT,
  product_id INT
);
Endpoint:
python
Copiar cÃ³digo
@app.route('/orders')
def get_orders():
    # Devuelve todas las Ã³rdenes desde la base de datos
Agregado a nginx.conf:
nginx
Copiar cÃ³digo
location /orders {
    proxy_pass http://order-service:5000/orders;
}
ğŸ’¡ ExtensiÃ³n opcional (bonus para nota mÃ¡xima):
Leer datos desde user-service y product-service usando peticiones HTTP internas.

Validar que el user_id y product_id existan antes de insertar en DB.

Exponer un endpoint POST /orders para crear Ã³rdenes desde el navegador o Postman.

ğŸ“ Entregables
CÃ³digo funcional del nuevo servicio (order-service) y su Dockerfile.

Fragmentos modificados de:

docker-compose.yml

nginx.conf

Capturas de prueba de endpoints (/orders) funcionando vÃ­a Gateway.

DocumentaciÃ³n corta (README.md) explicando:

CÃ³mo corre el servicio

QuÃ© hace

CÃ³mo se conecta al resto

ğŸ§  Habilidades desarrolladas
Habilidad	Detalle
DiseÃ±o de microservicios	SeparaciÃ³n de responsabilidades
Infraestructura como cÃ³digo (IaC)	ModificaciÃ³n avanzada de Docker Compose
ComunicaciÃ³n entre servicios	HTTP interno vÃ­a NGINX
IntegraciÃ³n continua de servicios	AÃ±adir sin romper arquitectura existente
ValidaciÃ³n cruzada y seguridad bÃ¡sica	Validar datos de usuarios/productos